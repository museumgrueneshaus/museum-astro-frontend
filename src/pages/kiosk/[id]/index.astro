---
import { getKioskConfig } from '../../../lib/sanity';

export async function getStaticPaths() {
  // Build-time: do not pre-generate kiosk pages (identifier list unknown/offline)
  return [];
}

const { id } = Astro.params;
const kioskConfig = await getKioskConfig(id).catch(() => null);

// Get modus from Sanity config and redirect to appropriate template
const modus = kioskConfig?.modus || 'explorer';

// Dynamically redirect to the correct mode page
if (modus === 'video') {
  return Astro.redirect(`/kiosk/${id}/video`);
} else if (modus === 'slideshow') {
  return Astro.redirect(`/kiosk/${id}/slideshow`);
} else if (modus === 'reader') {
  return Astro.redirect(`/kiosk/${id}/reader`);
} else {
  // Default to explorer
  return Astro.redirect(`/kiosk/${id}/explorer`);
}
